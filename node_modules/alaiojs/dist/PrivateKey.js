"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var elliptic_1 = require("elliptic");
var alaiojs_numeric_1 = require("./alaiojs-numeric");
/** Represents/stores a private key and provides easy conversion for use with `elliptic` lib */
var PrivateKey = /** @class */ (function () {
    function PrivateKey(key) {
        this.key = key;
    }
    /** Instantiate private key from an `elliptic`-format private key */
    PrivateKey.fromElliptic = function (privKey, keyType) {
        if (keyType === void 0) { keyType = alaiojs_numeric_1.KeyType.k1; }
        var privArray = privKey.getPrivate().toArray();
        return new PrivateKey({
            type: keyType,
            data: privKey.getPrivate().toBuffer(),
        });
    };
    /** Instantiate private key from an ALAIO-format private key */
    PrivateKey.fromString = function (keyString) {
        var key = alaiojs_numeric_1.stringToPrivateKey(keyString);
        if (key.type !== alaiojs_numeric_1.KeyType.k1) {
            throw new Error('Key type isn\'t k1');
        }
        return new PrivateKey(key);
    };
    /** Export private key as `elliptic`-format private key */
    PrivateKey.prototype.toElliptic = function (ecurve) {
        /** expensive to construct; so we do it only as needed */
        if (!ecurve) {
            if (this.key.type === alaiojs_numeric_1.KeyType.r1) {
                ecurve = new elliptic_1.ec('secp256r1');
            }
            else {
                ecurve = new elliptic_1.ec('secp256k1');
            }
        }
        return ecurve.keyFromPrivate(this.key.data);
    };
    /** Export private key as ALAIO-format private key */
    PrivateKey.prototype.toString = function () {
        return alaiojs_numeric_1.privateKeyToString(this.key);
    };
    return PrivateKey;
}());
exports.PrivateKey = PrivateKey;
//# sourceMappingURL=PrivateKey.js.map